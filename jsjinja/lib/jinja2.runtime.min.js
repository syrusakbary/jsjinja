(function() {
  __hasProp = {}.hasOwnProperty;
  __extends = function(a, b) {
    function c() {
      this.constructor = a;
    }
    for (var e in b) __hasProp.call(b, e) && (a[e] = b[e]);
    c.prototype = b.prototype;
    a.prototype = new c();
    a.__super__ = b.prototype;
    return a;
  };
  var k,
    d,
    p,
    q,
    m,
    r,
    s =
      [].indexOf ||
      function(a) {
        for (var b = 0, c = this.length; b < c; b++)
          if (b in this && this[b] === a) return b;
        return -1;
      };
  r = "undefined" !== typeof exports && null !== exports ? exports : this;
  p = function(a) {
    var b, c;
    c = {};
    for (b in a) a.hasOwnProperty(b) && (c[b] = a[b]);
    return c;
  };
  q = function(a, b) {
    var c, e;
    e = {};
    for (c in a) e[c] = a[c];
    for (c in b) e[c] = b[c];
    return e;
  };
  m = function(a, b, c, e, t, g) {
    var f;
    c = c || {};
    c = e ? c : q(t || {}, c);
    if (g)
      for (f in (e && (c = p(c)), g)) g[f] !== d.utils.missing && (c[f] = g[f]);
    return new k(c, a, b);
  };
  var n = function() {};
  n.prototype.add = function(a) {
    return (this[a] = !0);
  };
  n.prototype.remove = function(a) {
    return delete this[a];
  };
  var h = function() {
    var a, b;
    this.blocks = {};
    for (b in this)
      0 === b.indexOf("block_") &&
        ((a = b.slice(6)),
        (this.blocks[a] = this[b]),
        (this.blocks[a].__append_context__ = !0));
  };
  h.prototype.root = function() {};
  h.prototype.new_context = function(a, b, c) {
    return m(this.name, this.blocks, a, !!b, this.globals, c);
  };
  h.prototype.render = function(a) {
    return this.root(this.new_context(a));
  };
  h.prototype.render_block = function(a, b) {
    var c;
    c = new k(null, null, this.blocks);
    c.vars = b;
    return this["block_" + a](c);
  };
  h.prototype.module = function() {
    var a, b, c;
    a = new k();
    this.root(a);
    c = {};
    for (b in a.exported_vars) c[b] = a.vars[b];
    return c;
  };
  h.prototype.new_context = function(a, b, c) {
    return m(this.name, this.blocks, a, b, this.globals, c);
  };
  var l = function(a, b, c) {
    var e;
    this.parent = a;
    this.vars = {};
    this.blocks = {};
    for (e in c) this.blocks[e] = [c[e]];
    this.exported_vars = new n();
  };
  l.prototype["super"] = function(a, b) {
    var c, e;
    c = this.blocks[a];
    e = c.indexOf(b) + 1;
    return c[e];
  };
  l.prototype.resolve = function(a) {
    var b, c, e;
    return null != (b = this.vars) && b.hasOwnProperty(a)
      ? this.vars[a]
      : null != (c = this.parent) && c.resolve
        ? this.parent.resolve(a)
        : null != (e = this.parent) && e.hasOwnProperty(a)
          ? this.parent[a]
          : d.globals[a];
  };
  l.prototype.call = function(a, b, c) {
    var e, d, g;
    if (a) {
      d = !a.__args__ ? b : [];
      a.__append_context__ && d.push(this);
      a.__append_args__ && d.push(b);
      a.__append_kwargs__ && d.push(c);
      for (e in a.__args__)
        d.push(c[null != (g = a.__args__) ? g[e] : void 0] || b.pop());
      return a.apply(a.constructor || null, d);
    }
  };
  l.prototype.callfilter = function(a, b, c, e) {
    var d;
    if (a) {
      for (d in a.__args__) b.push(e[a.__args__[d]] || c.pop());
      return a.apply(null, b);
    }
  };
  k = l;
  d = {
    version: 0.2,
    templates: {},
    filters: {},
    globals: {},
    tests: {},
    registerGlobal: function(a, b) {
      return (this.globals[a] = b);
    },
    registerFilter: function(a, b) {
      return (this.filters[a] = b);
    },
    registerTest: function(a, b) {
      return (this.tests[a] = b);
    },
    getFilter: function(a) {
      return this.filters[a];
    },
    registerTemplate: function(a, b) {
      return (this.templates[a] = b);
    },
    getTemplate: function(a) {
      return new this.templates[a]();
    },
    utils: {
      to_string: function(a) {
        return a ? String(a) : "";
      },
      missing: void 0,
      format: function(a, b) {
        var c;
        c = -1;
        return a.replace(
          /%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd])/g,
          function(a, d, g, f, j, h) {
            if ("%%" === a) return "%";
            if (void 0 !== b[++c]) {
              a = f ? parseInt(f.substr(1)) : void 0;
              j = j ? parseInt(j.substr(1)) : void 0;
              f = void 0;
              switch (h) {
                case "s":
                  f = b[c];
                  break;
                case "c":
                  f = b[c][0];
                  break;
                case "f":
                  f = parseFloat(b[c]).toFixed(a);
                  break;
                case "p":
                  f = parseFloat(b[c]).toPrecision(a);
                  break;
                case "e":
                  f = parseFloat(b[c]).toExponential(a);
                  break;
                case "x":
                  f = parseInt(b[c]).toString(j ? j : 16);
                  break;
                case "d":
                  f = parseFloat(
                    parseInt(b[c], j ? j : 10).toPrecision(a)
                  ).toFixed(0);
              }
              f = "object" === typeof f ? JSON.stringify(f) : f.toString(j);
              a = parseInt(g);
              for (g = g && "0" === g[0] ? "0" : " "; f.length < a; )
                f = void 0 !== d ? f + g : g + f;
              return f;
            }
          }
        );
      },
      loop: function(a, b) {
        return {
          first: 0 === a,
          last: a === b - 1,
          index: a + 1,
          index0: a,
          revindex: b - a,
          revindex0: b - a - 1,
          length: b,
          cycle: function() {
            return arguments[a % arguments.length];
          }
        };
      }
    },
    __extends: __extends,
    Template: h,
    Context: k
  };
  r.Jinja2 = d;
  d.registerGlobal("range", function() {
    var a, b, c, d;
    d = b = c = void 0;
    a = [];
    switch (arguments.length) {
      case 1:
        c = 0;
        b = Math.floor(arguments[0]) - 1;
        d = 1;
        break;
      case 2:
      case 3:
        (c = Math.floor(arguments[0])),
          (b = Math.floor(arguments[1]) - 1),
          (d = arguments[2]),
          "undefined" === typeof d && (d = 1),
          (d = Math.floor(d));
    }
    if (0 < d) for (; c <= b; ) a.push(c), (c += d);
    else if (0 > d && ((d = -d), c > b))
      for (; c > b + 1; ) a.push(c), (c -= d);
    return a;
  });
  d.registerGlobal(
    "dict",
    (function() {
      var a;
      a = function(a) {
        return a;
      };
      a.__append_kwargs__ = !0;
      return a;
    })()
  );
  d.registerGlobal("cycler", function() {
    var a;
    a = {
      items: arguments,
      reset: function() {
        return a._setPos(0);
      },
      _setPos: function(b) {
        a.pos = b;
        return (a.current = a.items[b]);
      },
      next: function() {
        var b;
        b = a.current;
        a._setPos((a.pos + 1) % a.items.length);
        return b;
      }
    };
    a.reset();
    return a;
  });
  d.registerGlobal("joiner", function(a) {
    var b;
    a || (a = ",");
    b = !1;
    return function() {
      if (b) return a;
      b = !0;
      return "";
    };
  });
  d.registerFilter("length", function(a) {
    return a.length;
  });
  d.registerFilter("count", function(a) {
    return a.length;
  });
  d.registerFilter("indent", function(a, b, c) {
    b || (b = 4);
    b = b ? Array(b + 1).join(" ") : "";
    return (c ? a : a.replace(/\n$/, "")).replace(/\n/g, "\n" + b);
  });
  d.registerFilter("random", function(a, b) {
    if (b) return b[Math.floor(Math.random() * b.length)];
  });
  d.registerFilter("last", function(a, b) {
    if (b) return b[b.length - 1];
  });
  d.registerFilter("first", function(a, b) {
    if (b) return b[0];
  });
  d.registerFilter("title", function(a) {
    return a.replace(/\w\S*/g, function(a) {
      return a.charAt(0).toUpperCase() + a.substr(1).toLowerCase();
    });
  });
  d.registerFilter("lower", function(a) {
    return a.toLowerCase();
  });
  d.registerFilter("upper", function(a) {
    return a.toUpperCase();
  });
  d.registerFilter("capitalize", function(a) {
    return a.charAt(0).toUpperCase() + a.slice(1);
  });
  d.registerFilter("escape", function(a) {
    return String(a)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;");
  });
  d.registerFilter("default", function(a, b, c) {
    return (c && !a) || void 0 === a ? b : a;
  });
  d.registerFilter("truncate", function(a, b, c, d) {
    b || (b = 255);
    d || (d = "...");
    if (a.length <= b) return a;
    if (c) return a.substring(0, b);
    a = a.substring(0, maxLength + 1);
    a = a.substring(0, Math.min(a.length, a.lastIndexOf(" ")));
    return a + d;
  });
  d.registerTest("callable", function() {
    return !(!obj || !obj.constructor || !obj.call || !obj.apply);
  });
  d.registerTest("odd", function(a) {
    return 1 === a % 2;
  });
  d.registerTest("even", function(a) {
    return 0 === a % 2;
  });
  d.registerTest("divisibleby", function(a, b) {
    return 0 === a % b;
  });
  d.registerTest("defined", function(a) {
    return "undefined" !== typeof a;
  });
  d.registerTest("undefined", function(a) {
    return "undefined" === typeof a;
  });
  d.registerTest("none", function(a) {
    return null === a;
  });
  d.registerTest("lower", function(a) {
    return a === a.toLowerCase();
  });
  d.registerTest("upper", function(a) {
    return a === a.toUpperCase();
  });
  d.registerTest("string", function(a) {
    return "[object String]" === toString.call(a);
  });
  d.registerTest("mapping", function(a) {
    return a === Object(a);
  });
  d.registerTest("number", function(a) {
    return "[object Number]" === toString.call(a);
  });
  d.registerTest("sequence", function(a) {
    return "[object Array]" === toString.call(a);
  });
  d.registerTest("sameas", function(a, b) {
    return a === b;
  });
  d.registerTest("iterable", function(a) {
    return "[object Array]" === toString.call(a);
  });
  d.registerTest("escaped", function(a) {
    return 0 <= s.call(a, "__html__");
  });
}.call(this));
